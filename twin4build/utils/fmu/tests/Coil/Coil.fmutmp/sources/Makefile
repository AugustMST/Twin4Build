# Makefile generated by OpenModelica
CC=clang
AR=@AR@
CFLAGS=-Os -Wno-parentheses-equality -falign-functions -mstackrealign -msse2 -mfpmath=sse 
LD=$(CC) -shared
# define OMC_LDFLAGS_LINK_TYPE env variable to override this
OMC_LDFLAGS_LINK_TYPE=static
LDFLAGS=-L"C:/Program Files/OpenModelica1.18.0-64bit/lib//omc" -Wl,-rpath,"C:/Program Files/OpenModelica1.18.0-64bit/lib//omc" -fopenmp -Wl,-Bstatic -lregex -ltre -lintl -liconv -lexpat -lomcgc -lpthread -loleaut32 -limagehlp -lhdf5 -lz -lszip -Wl,-Bdynamic  -lSimulationRuntimeFMI  -Wl,-B$(OMC_LDFLAGS_LINK_TYPE) -lregex -ltre -lintl -liconv -static-libgcc -lpthread -lm  -lgfortran -lquadmath -lmingw32 -lgcc_eh -lmoldname -lmingwex  -luser32 -lkernel32 -ladvapi32 -lshell32 -limagehlp -lopenblas -lhdf5 -lz -lszip -Wl,-Bdynamic 
DLLEXT=.dll
NEED_RUNTIME=
NEED_DGESV=
NEED_SUNDIALS=
FMIPLATFORM=win64
# Note: Simulation of the fmu with dymola does not work with -finline-small-functions (enabled by most optimization levels)
CPPFLAGS=-I"C:/Program Files/OpenModelica1.18.0-64bit/include/omc/c/fmi" -DOMC_FMI_RUNTIME=1 -DCMINPACK_NO_DLL=1

override CPPFLAGS += "-IC:/Program Files/OpenModelica1.18.0-64bit/lib/omlibrary/Modelica 4.0.0/Resources/C-Sources"

CFILES = Coil.c \
         Coil_functions.c \
         Coil_records.c \
         Coil_01exo.c \
         Coil_02nls.c \
         Coil_03lsy.c \
         Coil_04set.c \
         Coil_05evt.c \
         Coil_06inz.c \
         Coil_07dly.c \
         Coil_08bnd.c \
         Coil_09alg.c \
         Coil_10asr.c \
         Coil_11mix.c \
         Coil_12jac.c \
         Coil_13opt.c \
         Coil_14lnz.c \
         Coil_15syn.c \
         Coil_16dae.c \
         Coil_17inl.c \
         Coil_18spd.c \
         Coil_init_fmu.c \
         Coil_FMU.c
OFILES=$(CFILES:.c=.o)

RUNTIMEDIR=.
ifneq ($(NEED_DGESV),)
DGESV_OBJS = 
endif
ifneq ($(NEED_RUNTIME),)
RUNTIMEFILES=./util/read_matlab4.o ./util/read_csv.o ./util/libcsv.o gc/memory_pool.o gc/omc_gc.o ./util/base_array.o ./util/boolean_array.o ./util/division.o ./util/doubleEndedList.o ./util/generic_array.o ./util/index_spec.o ./util/integer_array.o ./util/jacobian_util.o ./util/list.o ./util/modelica_string_lit.o ./util/modelica_string.o ./util/ModelicaUtilities.o ./util/omc_error.o ./util/omc_file.o ./util/omc_init.o ./util/omc_mmap.o ./util/omc_msvc.o ./util/omc_numbers.o ./util/parallel_helper.o ./util/rational.o ./util/real_array.o ./util/ringbuffer.o ./util/simulation_options.o ./util/string_array.o ./util/utility.o ./util/varinfo.o ./math-support/pivot.o ./simulation/omc_simulation_util.o ./simulation/options.o ./simulation/simulation_info_json.o ./simulation/simulation_omc_assert.o ./simulation/solver/delay.o ./simulation/solver/fmi_events.o ./simulation/solver/model_help.o ./simulation/solver/omc_math.o ./simulation/solver/spatialDistribution.o ./simulation/solver/stateset.o ./simulation/solver/synchronous.o ./simulation/solver/initialization/initialization.o ./meta/meta_modelica_catch.o $(DGESV_OBJS)
endif
ifneq ($(NEED_SUNDIALS),)
FMISUNDIALSFILES=
LDFLAGS+=-lsundials_cvode -lsundials_nvecserial
endif

PHONY: Coil_FMU
Coil_FMU: nozip
	cd .. && rm -f ../Coil.fmu && zip -r ../Coil.fmu *
nozip: Coil_functions.h Coil_literals.h $(OFILES) $(RUNTIMEFILES) $(FMISUNDIALSFILES)
	$(CXX) -shared -I. -o Coil$(DLLEXT) $(RUNTIMEFILES) $(FMISUNDIALSFILES) $(OFILES) $(CPPFLAGS) -L"C:/Users/jabj/OneDrive - Syddansk Universitet/PhD_Project_Jakob/Twin4build/Modelica/FMUPreparedModels"  "-LC:/Program Files/OpenModelica1.18.0-64bit/lib//omc" "-LC:/Program Files/OpenModelica1.18.0-64bit/lib/" "-LC:/Users/jabj/AppData/Roaming/.openmodelica/binaries/Modelica" "-LC:/Program Files/OpenModelica1.18.0-64bit/lib/omlibrary/Modelica 4.0.0/Resources/Library/mingw64" "-LC:/Program Files/OpenModelica1.18.0-64bit/lib/omlibrary/Modelica 4.0.0/Resources/Library/win64" "-LC:/Program Files/OpenModelica1.18.0-64bit/lib/omlibrary/Modelica 4.0.0/Resources/Library" -lModelicaExternalC $(CFLAGS) $(LDFLAGS) -llis -Wl,--kill-at
	mkdir.exe -p ../binaries/win64
	dlltool -d Coil.def --dllname Coil$(DLLEXT) --output-lib Coil.lib --kill-at
	cp Coil$(DLLEXT) Coil.lib Coil_FMU.libs ../binaries/win64/
	rm -f *.o Coil$(DLLEXT) $(OFILES) $(RUNTIMEFILES) $(FMISUNDIALSFILES)
	cd .. && rm -f ../Coil.fmu && zip -r ../Coil.fmu *

